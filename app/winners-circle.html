<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <style type="text/css">
      body {
        font-family: Arial;
      }
      h1 {
        color: #b3d4fc;
      }
      p {
        color: #000000;
      }
      tr {
        background-color: #2f3061;
      }
      td {
        background-color: #b3d4fc;
      }
      table {
        color: #ffffff;
      }
    </style>
  </head>

  <body>
    <h1>NaNo Winners</h1>
    <p>List of November Winners!</p>
    <div id="table"></div>
  </body>
    <script>
      const drawChart = async () => {
        const data = await d3.csv(
          "https://docs.google.com/spreadsheets/d/e/2PACX-1vS4miU2yF1wGCB2lqTVmsu9TcVdvNV_SxLRBxri5aAraCCt-7uoU9R7Rk1QgUjv9InRyNZsV4FAjZBk/pub?gid=1450622436&single=true&output=csv"
        );
        console.log(data);
        var myArray = [];
        data.forEach((d, i) => {
          d["novel_name"] = String(d["Name of Novel"]);
          d["username"] = String(d["Username"]);
          d["date"] = d["Date "];
          myArray.push([d.novel_name, d.username, d.date]);
        });

        console.log(data);
        console.log(data.columns.slice(1));
        var table = d3.select("body").append("table");
        var header = table.append("thead").append("tr");
        header
          .selectAll("th")
          .data(data.columns.slice(1))
          .enter()
          .append("th")
          .text(function (d) {
            return d;
          });
        var tablebody = table.append("tbody");
        rows = tablebody.selectAll("tr").data(myArray).enter().append("tr");
        var cells = rows
        cells
          .selectAll("td")
          .data(function (d) {
            console.log(d);
            return d;
          })
          .enter()
          .append("td")
          .text(function (d) {
            return d;
          });
      };
      drawChart();
    </script>
</html>